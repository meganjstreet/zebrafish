import t from"outlayer";import e from"get-size";import r from"desandro-matches-selector";import i from"fizzy-ui-utils";import o from"./item.js";import s from"./layout-mode.js";import"masonry-layout";import n from"./layout-modes/masonry.js";import a from"./layout-modes/fit-rows.js";import u from"./layout-modes/vertical.js";var h="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var l={};(function(h,m){l?l=m(h,t,e,r,i,o,s,n,a,u):h.Isotope=m(h,h.Outlayer,h.getSize,h.matchesSelector,h.fizzyUIUtils,h.Isotope.Item,h.Isotope.LayoutMode)})(window,(function factory(t,e,r,i,o,s,n){var a=t.jQuery;var u=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^\s+|\s+$/g,"")};var l=e.create("isotope",{layoutMode:"masonry",isJQueryFiltering:true,sortAscending:true});l.Item=s;l.LayoutMode=n;var m=l.prototype;m._create=function(){(this||h).itemGUID=0;(this||h)._sorters={};this._getSorters();e.prototype._create.call(this||h);(this||h).modes={};(this||h).filteredItems=(this||h).items;(this||h).sortHistory=["original-order"];for(var t in n.modes)this._initLayoutMode(t)};m.reloadItems=function(){(this||h).itemGUID=0;e.prototype.reloadItems.call(this||h)};m._itemize=function(){var t=e.prototype._itemize.apply(this||h,arguments);for(var r=0;r<t.length;r++){var i=t[r];i.id=(this||h).itemGUID++}this._updateItemsSortData(t);return t};m._initLayoutMode=function(t){var e=n.modes[t];var r=(this||h).options[t]||{};(this||h).options[t]=e.options?o.extend(e.options,r):r;(this||h).modes[t]=new e(this||h)};m.layout=function(){(this||h)._isLayoutInited||!this._getOption("initLayout")?this._layout():this.arrange()};m._layout=function(){var t=this._getIsInstant();this._resetLayout();this._manageStamps();this.layoutItems((this||h).filteredItems,t);(this||h)._isLayoutInited=true};m.arrange=function(t){this.option(t);this._getIsInstant();var e=this._filter((this||h).items);(this||h).filteredItems=e.matches;this._bindArrangeComplete();(this||h)._isInstant?this._noTransition((this||h)._hideReveal,[e]):this._hideReveal(e);this._sort();this._layout()};m._init=m.arrange;m._hideReveal=function(t){this.reveal(t.needReveal);this.hide(t.needHide)};m._getIsInstant=function(){var t=this._getOption("layoutInstant");var e=void 0!==t?t:!(this||h)._isLayoutInited;(this||h)._isInstant=e;return e};m._bindArrangeComplete=function(){var t,e,r;var i=this||h;function arrangeParallelCallback(){t&&e&&r&&i.dispatchEvent("arrangeComplete",null,[i.filteredItems])}this.once("layoutComplete",(function(){t=true;arrangeParallelCallback()}));this.once("hideComplete",(function(){e=true;arrangeParallelCallback()}));this.once("revealComplete",(function(){r=true;arrangeParallelCallback()}))};m._filter=function(t){var e=(this||h).options.filter;e=e||"*";var r=[];var i=[];var o=[];var s=this._getFilterTest(e);for(var n=0;n<t.length;n++){var a=t[n];if(!a.isIgnored){var u=s(a);u&&r.push(a);u&&a.isHidden?i.push(a):u||a.isHidden||o.push(a)}}return{matches:r,needReveal:i,needHide:o}};m._getFilterTest=function(t){return a&&(this||h).options.isJQueryFiltering?function(e){return a(e.element).is(t)}:"function"==typeof t?function(e){return t(e.element)}:function(e){return i(e.element,t)}};m.updateSortData=function(t){var e;if(t){t=o.makeArray(t);e=this.getItems(t)}else e=(this||h).items;this._getSorters();this._updateItemsSortData(e)};m._getSorters=function(){var t=(this||h).options.getSortData;for(var e in t){var r=t[e];(this||h)._sorters[e]=f(r)}};m._updateItemsSortData=function(t){var e=t&&t.length;for(var r=0;e&&r<e;r++){var i=t[r];i.updateSortData()}};var f=function(){function mungeSorter(t){if("string"!=typeof t)return t;var e=u(t).split(" ");var r=e[0];var i=r.match(/^\[(.+)\]$/);var o=i&&i[1];var s=getValueGetter(o,r);var n=l.sortDataParsers[e[1]];t=n?function(t){return t&&n(s(t))}:function(t){return t&&s(t)};return t}function getValueGetter(t,e){return t?function getAttribute(e){return e.getAttribute(t)}:function getChildText(t){var r=t.querySelector(e);return r&&r.textContent}}return mungeSorter}();l.sortDataParsers={parseInt:function(t){return parseInt(t,10)},parseFloat:function(t){return parseFloat(t)}};m._sort=function(){if((this||h).options.sortBy){var t=o.makeArray((this||h).options.sortBy);this._getIsSameSortBy(t)||((this||h).sortHistory=t.concat((this||h).sortHistory));var e=getItemSorter((this||h).sortHistory,(this||h).options.sortAscending);(this||h).filteredItems.sort(e)}};m._getIsSameSortBy=function(t){for(var e=0;e<t.length;e++)if(t[e]!=(this||h).sortHistory[e])return false;return true};function getItemSorter(t,e){return function sorter(r,i){for(var o=0;o<t.length;o++){var s=t[o];var n=r.sortData[s];var a=i.sortData[s];if(n>a||n<a){var u=void 0!==e[s]?e[s]:e;var h=u?1:-1;return(n>a?1:-1)*h}}return 0}}m._mode=function(){var t=(this||h).options.layoutMode;var e=(this||h).modes[t];if(!e)throw new Error("No layout mode: "+t);e.options=(this||h).options[t];return e};m._resetLayout=function(){e.prototype._resetLayout.call(this||h);this._mode()._resetLayout()};m._getItemLayoutPosition=function(t){return this._mode()._getItemLayoutPosition(t)};m._manageStamp=function(t){this._mode()._manageStamp(t)};m._getContainerSize=function(){return this._mode()._getContainerSize()};m.needsResizeLayout=function(){return this._mode().needsResizeLayout()};m.appended=function(t){var e=this.addItems(t);if(e.length){var r=this._filterRevealAdded(e);(this||h).filteredItems=(this||h).filteredItems.concat(r)}};m.prepended=function(t){var e=this._itemize(t);if(e.length){this._resetLayout();this._manageStamps();var r=this._filterRevealAdded(e);this.layoutItems((this||h).filteredItems);(this||h).filteredItems=r.concat((this||h).filteredItems);(this||h).items=e.concat((this||h).items)}};m._filterRevealAdded=function(t){var e=this._filter(t);this.hide(e.needHide);this.reveal(e.matches);this.layoutItems(e.matches,true);return e.matches};m.insert=function(t){var e=this.addItems(t);if(e.length){var r,i;var o=e.length;for(r=0;r<o;r++){i=e[r];(this||h).element.appendChild(i.element)}var s=this._filter(e).matches;for(r=0;r<o;r++)e[r].isLayoutInstant=true;this.arrange();for(r=0;r<o;r++)delete e[r].isLayoutInstant;this.reveal(s)}};var d=m.remove;m.remove=function(t){t=o.makeArray(t);var e=this.getItems(t);d.call(this||h,t);var r=e&&e.length;for(var i=0;r&&i<r;i++){var s=e[i];o.removeFrom((this||h).filteredItems,s)}};m.shuffle=function(){for(var t=0;t<(this||h).items.length;t++){var e=(this||h).items[t];e.sortData.random=Math.random()}(this||h).options.sortBy="random";this._sort();this._layout()};m._noTransition=function(t,e){var r=(this||h).options.transitionDuration;(this||h).options.transitionDuration=0;var i=t.apply(this||h,e);(this||h).options.transitionDuration=r;return i};m.getFilteredItemElements=function(){return(this||h).filteredItems.map((function(t){return t.element}))};return l}));var m=l;export default m;

